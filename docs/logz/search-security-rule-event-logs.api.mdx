---
id: search-security-rule-event-logs
title: "Fetch the logs that triggered a security event"
description: "Runs a search query in your Logz.io Log Monitoring account to fetch the logs that triggered the security rule and caused it to log a security event."
sidebar_label: "Fetch the logs that triggered a security event"
hide_title: true
hide_table_of_contents: true
api: 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
sidebar_class_name: "post api-method"
info_path: docs/logz/logz-io-api
custom_edit_url: null
hide_send_button: true
---

import ApiTabs from "@theme/ApiTabs";
import DiscriminatorTabs from "@theme/DiscriminatorTabs";
import MethodEndpoint from "@theme/ApiExplorer/MethodEndpoint";
import SecuritySchemes from "@theme/ApiExplorer/SecuritySchemes";
import MimeTabs from "@theme/MimeTabs";
import ParamsItem from "@theme/ParamsItem";
import ResponseSamples from "@theme/ResponseSamples";
import SchemaItem from "@theme/SchemaItem";
import SchemaTabs from "@theme/SchemaTabs";
import TabItem from "@theme/TabItem";

<h1 className={"openapi__heading"}>Fetch the logs that triggered a security event</h1>

<MethodEndpoint method={"post"} path={"/v2/security/rules/events/logs/search"}></MethodEndpoint>



Runs a search query in your Logz.io Log Monitoring account to fetch the logs that triggered the security rule and caused it to log a security event.

This query returns an array of parsed logs linked to a single event - it isn't a bulk action. Run this query to investigate an event and increase observability into details omitted from the security event log.

**Note:** Run this endpoint with an API token for your Logz.io Security account.

## Request

<MimeTabs className={"openapi-tabs__mime"}><TabItem label={"application/json"} value={"application/json-schema"}><details style={{}} className={"openapi-markdown__details mime"} data-collapsed={false} open={true}><summary style={{}} className={"openapi-markdown__details-summary-mime"}><h3 className={"openapi-markdown__details-summary-header-body"}>Body</h3></summary><div style={{"textAlign":"left","marginLeft":"1rem"}}></div><ul style={{"marginLeft":"1rem"}}><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}} className={"openapi-markdown__details"}><summary style={{}}><span className={"openapi-schema__container"}><strong className={"openapi-schema__property"}>filter</strong><span className={"openapi-schema__name"}> object</span><span className={"openapi-schema__divider"}></span><span className={"openapi-schema__required"}>required</span></span></summary><div style={{"marginLeft":"1rem"}}><div style={{"marginTop":".5rem","marginBottom":".5rem"}}>

Filter by the event's unique GUID to retrieve only the logs relevant to the event under investigation.

</div><SchemaItem collapsible={false} name={"alertEventId"} required={true} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string","description":"Unique GUID of the security event in Logz.io Cloud SIEM. The GUID is returned in the results when querying to fetch security events or by inspecting an event log in the [UI](https://app.logz.io/#/dashboard/security/research/discover?) under the field `logzio-alert-event-id`.","example":"833203f9-de71-5a12-9083-9055a6d925bb"}}></SchemaItem></div></details></SchemaItem><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}} className={"openapi-markdown__details"}><summary style={{}}><span className={"openapi-schema__container"}><strong className={"openapi-schema__property"}>pagination</strong><span className={"openapi-schema__name"}> object</span></span></summary><div style={{"marginLeft":"1rem"}}><div style={{"marginTop":".5rem","marginBottom":".5rem"}}>

Default pagination is a page of 25 results. Look for the `total` field in the response for the number of available results overall, and use the pagination function to page through the results.

</div><SchemaItem collapsible={false} name={"pageNumber"} required={false} schemaName={"int32"} qualifierMessage={undefined} schema={{"type":"integer","format":"int32","description":"If you overshoot the page number, it will return empty with no results, but it won't fail the request.","default":1,"example":2}}></SchemaItem><SchemaItem collapsible={false} name={"pageSize"} required={false} schemaName={"int32"} qualifierMessage={"**Possible values:** `<= 1000`"} schema={{"type":"integer","format":"int32","description":"Controls the number of results per page. Valid inputs are 1 to 1000.","maximum":1000,"default":25,"example":100}}></SchemaItem></div></details></SchemaItem></ul></details></TabItem></MimeTabs><div><div><ApiTabs><TabItem label={"200"} value={"200"}><div>

successful operation

</div><details style={{"textAlign":"left","marginBottom":"1rem"}} className={"openapi-markdown__details"} data-collaposed={true} open={false}><summary style={{}}><strong>Response Headers</strong></summary><ul style={{"marginLeft":"1rem"}}></ul></details><div><MimeTabs className={"openapi-tabs__mime"} schemaType={"response"}><TabItem label={"application/json"} value={"application/json"}><SchemaTabs className={"openapi-tabs__schema"}><TabItem label={"Schema"} value={"Schema"}><details style={{}} className={"openapi-markdown__details response"} data-collapsed={false} open={true}><summary style={{}} className={"openapi-markdown__details-summary-response"}><strong>Schema</strong></summary><div style={{"textAlign":"left","marginLeft":"1rem"}}></div><ul style={{"marginLeft":"1rem"}}><SchemaItem collapsible={false} name={"total"} required={false} schemaName={"int32"} qualifierMessage={undefined} schema={{"description":"Returns the total number of logs linked to the security event specified in the query. This number is fixed and not affected by pagination.","type":"integer","format":"int32","example":5}}></SchemaItem><SchemaItem collapsible={false} name={"results"} required={false} schemaName={"object[]"} qualifierMessage={undefined} schema={{"type":"array","description":"Array of logs returned in answer to the query. The logs are returned in their entirety and parsed.\n\nIf the logs are no longer retained in the database, the request will return empty. You can check your account's log retention policy in your [log monitoring account](https://app.logz.io/#/dashboard/settings/usage-and-billing).","items":{"type":"object","example":{"Array of logs":null}}}}></SchemaItem><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}} className={"openapi-markdown__details"}><summary style={{}}><span className={"openapi-schema__container"}><strong className={"openapi-schema__property"}>pagination</strong><span className={"openapi-schema__name"}> object</span></span></summary><div style={{"marginLeft":"1rem"}}><div style={{"marginTop":".5rem","marginBottom":".5rem"}}>

Default pagination is a page of 25 results. Look for the `total` field in the response for the number of available results overall, and use the pagination function to page through the results.

</div><SchemaItem collapsible={false} name={"pageNumber"} required={false} schemaName={"int32"} qualifierMessage={undefined} schema={{"type":"integer","format":"int32","description":"If you overshoot the page number, it will return empty with no results, but it won't fail the request.","default":1,"example":2}}></SchemaItem><SchemaItem collapsible={false} name={"pageSize"} required={false} schemaName={"int32"} qualifierMessage={"**Possible values:** `<= 1000`"} schema={{"type":"integer","format":"int32","description":"Controls the number of results per page. Valid inputs are 1 to 1000.","maximum":1000,"default":25,"example":100}}></SchemaItem></div></details></SchemaItem></ul></details></TabItem><TabItem label={"Example (from schema)"} value={"Example (from schema)"}><ResponseSamples responseExample={"{\n  \"total\": 5,\n  \"results\": [\n    {\n      \"Array of logs\": null\n    }\n  ],\n  \"pagination\": {\n    \"pageNumber\": 2,\n    \"pageSize\": 100\n  }\n}"} language={"json"}></ResponseSamples></TabItem></SchemaTabs></TabItem></MimeTabs></div></TabItem></ApiTabs></div></div>
